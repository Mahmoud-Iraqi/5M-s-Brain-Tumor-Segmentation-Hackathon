import torch.nn as nnimport torch.nn.functional as Fclass DiceCELoss(nn.Module):    def __init__(self):        super().__init__()        self.ce = nn.CrossEntropyLoss()    def forward(self, pred, target):        ce = self.ce(pred, target)        probs = F.softmax(pred, dim=1)        oh = F.one_hot(target, pred.shape[1]).permute(0,3,1,2).float()        inter = (probs * oh).sum((2,3))        union = probs.sum((2,3)) + oh.sum((2,3))        dice = 1 - ((2*inter+1e-5)/(union+1e-5)).mean()        return 0.5*ce + 0.4*dice