from config import CFG, TRAIN_DIRfrom dataset import BraTS2DSmartDatasetfrom model import ResNet34UNetfrom losses import DiceCELossfrom torch.utils.data import DataLoader, random_splitimport torchds = BraTS2DSmartDataset(    TRAIN_DIR,    "train",    CFG["IMG_SIZE"],    CFG["SLICES_PER_PATIENT"],    CFG["TARGET_PATIENTS"])train_ds, val_ds = random_split(ds, [int(0.9*len(ds)), len(ds)//10])train_loader = DataLoader(train_ds, batch_size=CFG["BATCH_SIZE"], shuffle=True)val_loader = DataLoader(val_ds, batch_size=CFG["BATCH_SIZE"])model = ResNet34UNet(CFG["NUM_CLASSES"]).to(CFG["DEVICE"])optimizer = torch.optim.Adam(model.parameters(), lr=CFG["LR"])criterion = DiceCELoss()